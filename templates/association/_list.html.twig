{% if associations is not empty %}
    {% set grouped = {} %}

    {% for association in associations %}
        {% set firstLetter = association.name|first|upper %}
        {% if grouped[firstLetter] is not defined %}
            {% set grouped = grouped|merge({ (firstLetter): [association] }) %}
        {% else %}
            {% set grouped = grouped|merge({ (firstLetter): grouped[firstLetter]|merge([association]) }) %}
        {% endif %}
    {% endfor %}

    <div class="masonry">
        {% for letter in grouped|keys|sort %}
            <div class="col">
                <h4 class="mt-3">{{ letter }}</h4>
                <div class="list-group mb-3">
                    {% for assoc in grouped[letter]|sort((a, b) => a.name <=> b.name) %}
                        <a href="{{ path('association_show', {slug: assoc.slug}) }}" class="list-group-item list-group-item-action {% if assoc.wip %}wip{% endif%} d-flex justify-content-between" data-categories="{{ assoc.categories|json_encode }}">
                            <div>
                                {% if assoc.wip %}
                                    <span title="{{ 'association.wip'|trans }}">
                                        {% include 'common/construction-cone.svg.twig' %}
                                    </span>
                                {% endif %}
                                <span>
                                    {{ assoc.name|mark(searchTerm|default) }}{% if app.user|default and app.user.isSubscribedTo(assoc) %}&nbsp;<i class="fa fa-star text-warning" title="{{ 'association.subscription.info'|trans }}"></i>{% endif %}
                                </span>
                            </div>
                            <span>
                                {% if assoc.categories|default %}
                                    {% for category in assoc.categories %}
                                        <i class="{{ category.icon }} text-{{ category.badge }}" title="{{ ('association.category.' ~ category.value)|trans }}"></i>&nbsp;
                                    {% endfor %}
                                {% endif %}
                            </span>
                        </a>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="alert alert-info mt-3">{{ customEmptyMessage is defined ? customEmptyMessage : 'home.associations.list.none'|trans }}</div>
{% endif %}
